<!DOCTYPE html>
<html>
    <head>
        <title>BLACKJACK</title>
        <link rel="stylesheet" href="css/reset.css" type="text/css">
        <link rel="stylesheet" href="css/main.css" type="text/css">
        <link rel="stylesheet" href="css/orientation_utils.css" type="text/css">
        <link rel="stylesheet" href="css/ios_fullscreen.css" type="text/css">
        <link rel='shortcut icon' type='image/x-icon' href='./favicon.ico' />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
	<meta name="msapplication-tap-highlight" content="no"/>

        <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
        <script type="text/javascript" src="js/createjs-2015.11.26.min.js"></script>
        <script type="text/javascript" src="js/platform.js"></script>
        <script type="text/javascript" src="js/ios_fullscreen.js"></script>
        <script type="text/javascript" src="js/howler.min.js"></script>
        <script type="text/javascript" src="js/screenfull.js"></script>
        <script type="text/javascript" src="js/ctl_utils.js"></script>
        <script type="text/javascript" src="js/sprite_lib.js"></script>
        <script type="text/javascript" src="js/settings.js"></script>
        <script type="text/javascript" src="js/CLang.min.js"></script>
        <script type="text/javascript" src="js/CPreloader.js"></script>
        <script type="text/javascript" src="js/CMain.js"></script>
        <script type="text/javascript" src="js/CTextButton.js"></script>
        <script type="text/javascript" src="js/CGfxButton.js"></script>
        <script type="text/javascript" src="js/CToggle.js"></script>
        <script type="text/javascript" src="js/CMenu.js"></script>
        <script type="text/javascript" src="js/CGame.js"></script>
        <script type="text/javascript" src="js/CInterface.js"></script>
        <script type="text/javascript" src="js/CTweenController.js"></script>
        <script type="text/javascript" src="js/CSeat.js"></script>
        <script type="text/javascript" src="js/CFichesController.js"></script>
        <script type="text/javascript" src="js/CVector2.js"></script>
        <script type="text/javascript" src="js/CGameSettings.js"></script>
        <script type="text/javascript" src="js/CEasing.js"></script>
        <script type="text/javascript" src="js/CHandController.js"></script>
        <script type="text/javascript" src="js/CCard.js"></script>
        <script type="text/javascript" src="js/CInsurancePanel.js"></script>
        <script type="text/javascript" src="js/CGameOver.js"></script>
        <script type="text/javascript" src="js/CMsgBox.js"></script>
        <script type="text/javascript" src="js/CCreditsPanel.js"></script>
        <script type="text/javascript" src="js/CFiche.js"></script>
        <script type="text/javascript" src="js/CCTLText.js"></script>
    </head>
    <body ondragstart="return false;" ondrop="return false;" >
	<div style="position: fixed; background-color: transparent; top: 0px; left: 0px; width: 100%; height: 100%; pointer-events: none;"></div>
          <script>
            // Parent window communication for iframe integration
            var parentOrigin = '*';
            var lastSavedScore = 0;
            
            // Listen for messages from parent window
            window.addEventListener('message', function(event) {
                var data = event.data;
                if (data && data.type === 'SET_CREDITS') {
                    // Update game credits from parent
                    if (typeof s_oGame !== 'undefined' && s_oGame !== null) {
                        s_oGame.setMoney(data.data.credits);
                        lastSavedScore = data.data.credits;
                    }
                }
            });
            
            // Notify parent that game is ready
            function notifyParentReady() {
                if (window.parent !== window) {
                    window.parent.postMessage({ type: 'GAME_READY' }, parentOrigin);
                }
            }
            
            // Send score update to parent
            function sendScoreToParent(score) {
                if (window.parent !== window && score !== lastSavedScore) {
                    window.parent.postMessage({ type: 'SAVE_SCORE', data: { score: score } }, parentOrigin);
                    lastSavedScore = score;
                }
            }
            
            // Request recharge from parent
            function requestRechargeFromParent() {
                if (window.parent !== window) {
                    window.parent.postMessage({ type: 'RECHARGE_REQUEST' }, parentOrigin);
                }
            }
            
            $(document).ready(function(){
                     var oMain = new CMain({
                                    win_occurrence: 40,          //WIN OCCURRENCE PERCENTAGE. VALUES BETWEEN 0-100
                                    min_bet: 1,                  //MIN BET PLAYABLE BY USER. DEFAULT IS 0.1$
                                    max_bet: 300,                //MAX BET PLAYABLE BY USER. 
                                    bet_time: 10000,             //WAITING TIME FOR PLAYER BETTING
                                    money: 1000,                 //STARING CREDIT FOR THE USER
                                    blackjack_payout: 1.5,       //PAYOUT WHEN USER WINS WITH BLACKJACK (DEFAULT IS 3 TO 2). BLACKJACK OCCURS WHEN USER GET 21 WITH FIRST 2 CARDS
                                    game_cash: 500,              //GAME CASH AVAILABLE WHEN GAME STARTS
                                    show_credits:true,           //ENABLE/DISABLE CREDITS BUTTON IN THE MAIN SCREEN
                                    fullscreen:false,            //Disabled for iframe
                                    check_orientation:false,      //SET TO FALSE IF YOU DON'T WANT TO SHOW ORIENTATION ALERT ON MOBILE DEVICES
                                    audio_enable_on_startup:false, //ENABLE/DISABLE AUDIO WHEN GAME STARTS 

                                    //////////////////////////////////////////////////////////////////////////////////////////
                                    ad_show_counter: 3           //NUMBER OF HANDS PLAYED BEFORE AD SHOWN
                                    //
                                    //// THIS FUNCTIONALITY IS ACTIVATED ONLY WITH CTL ARCADE PLUGIN.///////////////////////////
                                    /////////////////// YOU CAN GET IT AT: /////////////////////////////////////////////////////////
                                    // http://codecanyon.net/item/ctl-arcade-wordpress-plugin/13856421 ///////////
                                });


					 
                    $(oMain).on("recharge", function(evt) {
                             // Request credits from parent window
                             requestRechargeFromParent();
                    });
                    
                    $(oMain).on("bet_placed", function (evt, iTotBet) {
                        // Send updated score after bet
                        if (typeof s_oGame !== 'undefined' && s_oGame !== null) {
                            sendScoreToParent(s_oGame.getMoney());
                        }
                    });
                
                    $(oMain).on("start_session", function(evt) {
                        // Notify parent game started
                        notifyParentReady();
                    });

                    $(oMain).on("end_session", function(evt) {
                           // Send final score on session end
                           if (typeof s_oGame !== 'undefined' && s_oGame !== null) {
                               sendScoreToParent(s_oGame.getMoney());
                           }
                    });


                    $(oMain).on("save_score", function(evt,iScore) {
                           // Send score to parent
                           sendScoreToParent(iScore);
                    });

                    $(oMain).on("show_interlevel_ad", function(evt) {
                           // No ads in iframe mode
                    });

                    $(oMain).on("share_event", function(evt, iScore) {
                           // Share handled by parent
                           sendScoreToParent(iScore);
                    });
                    
                    if (isIOS()) {
                        setTimeout(function () {
                            sizeHandler();
                        }, 200);
                    } else {
                        sizeHandler();
                    }
                    
                    // If in iframe, call sizeHandler again after delay to ensure proper sizing
                    if (window.self !== window.top) {
                        setTimeout(sizeHandler, 500);
                        setTimeout(sizeHandler, 1000);
                        setTimeout(sizeHandler, 2000);
                    }
                    
                    // Notify parent that game is loaded
                    setTimeout(notifyParentReady, 2000);
           });

        </script>
        
        <div class="check-fonts">
            <p class="check-font-1">test 1</p>
        </div> 
        
        <canvas id="canvas" class='ani_hack' width="1700" height="768" style="display:block;"> </canvas>
        <div data-orientation="landscape" class="orientation-msg-container"><p class="orientation-msg-text">Please rotate your device</p></div>
	<div id="block_game" style="position: fixed; background-color: transparent; top: 0px; left: 0px; width: 100%; height: 100%; display:none; pointer-events: none;"></div>
    </body>
</html>